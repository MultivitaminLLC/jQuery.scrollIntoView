/*!
 * $.fn.scrollIntoView - similar to the default browser scrollIntoView
 * The default browser behavior always places the element at the top or bottom of its container. 
 * This override is smart enough to not scroll if the element is already visible.
 *
 * Copyright 2011 Arwid Bancewicz
 * Licensed under the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * @date 8 Jan 2013
 * @author Arwid Bancewicz http://arwid.ca
 * @version 0.3
 *
 * @date 15 Jan
 * @author Alexander Kataev
 */
!function(o){o.fn.scrollIntoView=function(t,e,n){function l(t,e,n){e-=s.offset*n,void 0===e?o.isFunction(s.complete)&&s.complete.call(t):s.smooth?o(t).stop().animate({scrollTop:e},s):(t.scrollTop=e,o.isFunction(s.complete)&&s.complete.call(t))}var s=o.extend({},o.fn.scrollIntoView.defaults);"object"==o.type(t)?o.extend(s,t):"number"==o.type(t)?o.extend(s,{duration:t,easing:e,complete:n}):0==t&&(s.smooth=!1);var i=1/0,r=0;1==this.size()?null==(i=this.get(0).offsetTop)||(r=i+this.get(0).offsetHeight):this.each(function(o,t){t.offsetTop<i?i=t.offsetTop:t.offsetTop+t.offsetHeight>r?r=t.offsetTop+t.offsetHeight:null}),r-=i;for(var f=this.commonAncestor().get(0),c=o(window).height();f;){var a=f.scrollTop,p=f.clientHeight;if(p>c&&(p=c),0==p&&"BODY"==f.tagName&&(p=c),f.scrollTop!=(null==(f.scrollTop+=1)||f.scrollTop)&&null!=(f.scrollTop-=1)||f.scrollTop!=(null==(f.scrollTop-=1)||f.scrollTop)&&null!=(f.scrollTop+=1))return void(a>=i?l(f,i,1):i+r>a+p?l(f,i+r-p,-1):l(f,void 0,0));f=f.parentNode}return this},o.fn.scrollIntoView.defaults={offset:0,smooth:!0,duration:null,easing:o.easing&&o.easing.easeOutExpo?"easeOutExpo":null,complete:o.noop(),step:null,specialEasing:{}},o.fn.isOutOfView=function(o){var t=!0;return this.each(function(){var e=this.parentNode,n=e.scrollTop,l=e.clientHeight,s=this.offsetTop,i=this.offsetHeight;(o?s>n+l:s+i>n+l)||(o?n>s+i:n>s)||(t=!1)}),t},o.fn.commonAncestor=function(){var t=[],e=1/0;o(this).each(function(){var n=o(this).parents();t.push(n),e=Math.min(e,n.length)});for(var n=0;n<t.length;n++)t[n]=t[n].slice(t[n].length-e);for(var n=0;n<t[0].length;n++){var l=!0;for(var s in t)if(t[s][n]!=t[0][n]){l=!1;break}if(l)return o(t[0][n])}return o([])}}(jQuery);